# Coze智能对话助手 - 对话记忆功能说明

## 功能概述

本应用已集成完整的对话记忆功能，解决了Coze API不自动保存对话历史的问题。现在你的AI助手可以像ChatGPT一样记住之前的对话内容了！

## 主要功能

### 1. 自动对话记忆
- **自动保存**：每次对话后自动保存到浏览器本地存储
- **自动恢复**：刷新页面后自动恢复上次的对话
- **上下文保持**：AI能够理解并记住之前的对话内容

### 2. 手动管理功能
页面右上角提供三个操作按钮：

- **保存按钮** 📥：将当前对话导出为JSON文件
- **加载按钮** 📂：从JSON文件导入历史对话
- **清空按钮** 🗑️：清除当前对话（需要确认）

### 3. 配置选项

在代码的配置区域，你可以调整以下设置：

```javascript
// 对话记忆配置
enableMemory: true,        // 是否启用对话记忆（默认开启）
maxHistoryLength: 20       // 最大历史记录长度（默认20条）
```

## 使用说明

### 基本使用
1. 正常与AI对话，系统会自动保存每条消息
2. 刷新页面后，之前的对话会自动恢复
3. AI会基于历史对话提供连贯的回复

### 导出对话
1. 点击"保存"按钮
2. 系统会下载一个包含所有对话的JSON文件
3. 文件名格式：`coze_chat_时间戳.json`

### 导入对话
1. 点击"加载"按钮
2. 选择之前保存的JSON文件
3. 系统会恢复该文件中的对话历史

### 清空对话
1. 点击"清空"按钮
2. 确认后会清除所有对话历史
3. 本地存储也会被清空

## 技术细节

### 工作原理
1. 每次发送消息时，系统会将用户消息和AI回复保存到`chatHistory`数组
2. 在API请求中包含`chat_history`参数，确保AI能看到历史对话
3. 使用localStorage进行本地持久化存储

### 存储限制
- 浏览器localStorage通常有5-10MB的限制
- 建议定期导出重要对话
- 可通过`maxHistoryLength`控制发送给API的历史长度

### 隐私说明
- 所有对话数据仅保存在你的浏览器本地
- 不会上传到任何服务器
- 清除浏览器数据会删除所有保存的对话

## 常见问题

### Q: 为什么需要手动管理对话历史？
A: Coze API本身不会自动保存对话上下文，需要在每次请求时手动传入历史记录。

### Q: 对话历史会占用很多空间吗？
A: 文本对话占用空间很小，一般几千条对话也只需要几MB。

### Q: 可以关闭对话记忆功能吗？
A: 可以，将配置中的`enableMemory`设置为`false`即可。

### Q: 不同的Bot之间会共享对话历史吗？
A: 不会，每个Bot的对话历史是独立保存的。

## 更新日志

### v1.0 (2025-01-17)
- 添加完整的对话记忆功能
- 支持自动保存和恢复
- 添加手动导入/导出功能
- 优化用户界面

---

如有问题或建议，欢迎反馈！ 